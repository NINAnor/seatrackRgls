<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Edit twilights by location-dependent thresholds. — move_twilights • seatrackRgls</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Edit twilights by location-dependent thresholds. — move_twilights"><meta name="description" content="This filter identify and act on false twilights that fulfil two conditions:
first, the twilight must be clearly different from its adjacent twilights of the same type (e.g sunsets),
and second, both adjacent twilights must occur at a similar time of day.
If these conditions are fulfilled, the time of day for the identified twilight is changed to the average of
both adjacent twilights.
The filter will have no effect in periods where the variation in twilight timing is high,
either due to migration, or the unfortunate influence of shadow and artificial light is present over several days."><meta property="og:description" content="This filter identify and act on false twilights that fulfil two conditions:
first, the twilight must be clearly different from its adjacent twilights of the same type (e.g sunsets),
and second, both adjacent twilights must occur at a similar time of day.
If these conditions are fulfilled, the time of day for the identified twilight is changed to the average of
both adjacent twilights.
The filter will have no effect in periods where the variation in twilight timing is high,
either due to migration, or the unfortunate influence of shadow and artificial light is present over several days."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">seatrackRgls</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/example.html">workflow tutorial</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Edit twilights by location-dependent thresholds.</h1>

      <div class="d-none name"><code>move_twilights.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This filter identify and act on false twilights that fulfil two conditions:
first, the twilight must be clearly different from its adjacent twilights of the same type (e.g sunsets),
and second, both adjacent twilights must occur at a similar time of day.
If these conditions are fulfilled, the time of day for the identified twilight is changed to the average of
both adjacent twilights.
The filter will have no effect in periods where the variation in twilight timing is high,
either due to migration, or the unfortunate influence of shadow and artificial light is present over several days.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">move_twilights</span><span class="op">(</span><span class="va">df</span>, <span class="va">speed</span>, <span class="va">sun</span>, <span class="va">show_plot</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>Input data with tFirst, tSecond, type</p></dd>


<dt id="arg-speed">speed<a class="anchor" aria-label="anchor" href="#arg-speed"></a></dt>
<dd><p>Maximum expected movement rate as km/h, sustained between two locations with ~12 hours in between. Second location in a pair will be removed.</p></dd>


<dt id="arg-sun">sun<a class="anchor" aria-label="anchor" href="#arg-sun"></a></dt>
<dd><p>calibrated sun angles per date</p></dd>


<dt id="arg-show-plot">show_plot<a class="anchor" aria-label="anchor" href="#arg-show-plot"></a></dt>
<dd><p>TRUE or FALSE</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with edited twilights.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function performs the following steps:</p><ol><li><p>Make time circular.</p></li>
<li><p>Make a reference table for selecting thresholds (daily change of light per lat/month in min*2 + 15m variance).</p></li>
<li><p>Define  the threshold in minutes for which A and C is considered the same (twilight A will define the threshold):</p></li>
<li><p>For this we use the reference table to select the right month and which reference latitude that is closest to the birds' approx. latitude</p></li>
<li><p>During an approx equinox period the function use estimated lats based on 10 lats before and after equinox period</p></li>
<li><p>for a few remaining NA's, the average threshold across lats and months is used (22 min)</p></li>
<li><p>Threshold for B different from A and C: minutes_different &lt;- (speed / 24) * 8 (20 min is minimum) + rate of change in daylight</p></li>
<li><p>Produce plot with affected twilights highlighted</p></li>
</ol></div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vegard Sandøy Bråthen, Julian Evans.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

