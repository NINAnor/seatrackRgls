<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>workflow tutorial • seatrackRgls</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="workflow tutorial">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">seatrackRgls</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/example.html">workflow tutorial</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>workflow tutorial</h1>
            
      

      <div class="d-none name"><code>example.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ninanor.github.io/seatrackRgls/">seatrackRgls</a></span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span></span>
<span>  collapse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comment <span class="op">=</span> <span class="st">"#&gt;"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Prepare basic metadata for calibration. Basic metadata must have
<code>logger_id</code>, <code>logger_model</code>, <code>species</code>,
<code>colony</code>, <code>date_deployed</code>,
<code>date_retrieved</code> columns. It is expected to be one row per
logger/retrieval year combination.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">example_metadata</span><span class="op">)</span></span>
<span><span class="co">#&gt;   logger_id logger_model date_deployed date_retrieved  colony</span></span>
<span><span class="co">#&gt; 1      C411       mk4083    2015-06-11     2017-06-11 Sklinna</span></span>
<span><span class="co">#&gt;                  species</span></span>
<span><span class="co">#&gt; 1 Black-legged kittiwake</span></span></code></pre></div>
<p>Prepare colony information. Colony information must have
<code>colony</code>, <code>col_lat</code>, <code>col_lon</code>
columns.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">example_colony_info</span><span class="op">)</span></span>
<span><span class="co">#&gt;    colony col_lat col_lon</span></span>
<span><span class="co">#&gt; 1 Sklinna  65.202  10.995</span></span></code></pre></div>
<p>Set your import directory, where your light data is placed. Light
data is expected to be in the format
<code>&lt;logger_id&gt;_&lt;year_retrieved&gt;_&lt;logger_model&gt;</code>,
e.g. <code>C411_2017_mk4083</code></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">import_dir</span> <span class="op">&lt;-</span> <span class="st">"light_data"</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">import_dir</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "C411_2017_mk4083.lig"</span></span></code></pre></div>
<p>Also set up an export directory, where all outputs will be saved.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">export_dir</span> <span class="op">&lt;-</span> <span class="st">"processed_light_data"</span></span></code></pre></div>
<p>With all this loaded, you can now carry out the first step which is
to calibrate your data. To assist in this, there is an initial round of
processing that generates helpful plots to choose calibration values</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/prepare_calibration.html">prepare_calibration</a></span><span class="op">(</span></span>
<span>  import_directory <span class="op">=</span> <span class="va">import_dir</span>,</span>
<span>  metadata <span class="op">=</span> <span class="va">example_metadata</span>,</span>
<span>  all_colony_info <span class="op">=</span> <span class="va">example_colony_info</span>,</span>
<span>  output_dir <span class="op">=</span> <span class="va">export_dir</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You will find the calibration plots in the <code>sun_calib</code>
folder created on your <code>output_dir</code>.</p>
<p><img src="example_files/figure-html/calibplot_1-1.png" class="r-plt" width="100%" style="display: block; margin: auto;"></p>
<p><img src="example_files/figure-html/calibplot_2-1.png" class="r-plt" width="100%" style="display: block; margin: auto;"></p>
<p>Stare at these plots. Use the force.</p>
<p>By default, this code will also have generated an excel file in the
<code>calibration</code> folder. You can use this to enter your
calibration values.</p>
<p><img src="../reference/figures/excel_screenshot.png" class="r-plt" width="90%"></p>
<p>You must fill in at least the sun_angle_start column. It is also
reccomended to include your name in the analyzer column.</p>
<p>Once you have filled in your calibration template, you can use these
values to process the light data and export positions.</p>
<p>We can pass a path to the calibration data file:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">calibration_data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">export_dir</span>, <span class="st">"calibration"</span>, <span class="st">"calibration.xlsx"</span><span class="op">)</span></span></code></pre></div>
<p>At this stage, we might want to include some extra relevant
information in the final data output.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">example_extra_metadata</span><span class="op">)</span></span>
<span><span class="co">#&gt;   logger_id date_retrieved logger_producer ring_number country_code</span></span>
<span><span class="co">#&gt; 1      C411     2017-06-11        Biotrack     6211704          NOS</span></span></code></pre></div>
<p>The final positions are now exported to your
<code>output_dir</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">positions</span><span class="op">)</span></span>
<span><span class="co">#&gt;   logger_id logger_id_year total_years_tracked logger_model start_datetime</span></span>
<span><span class="co">#&gt; 1      C411      C411_2016           2015_2016       mk4083     2015-06-12</span></span>
<span><span class="co">#&gt; 2      C411      C411_2016           2015_2016       mk4083     2015-06-12</span></span>
<span><span class="co">#&gt; 3      C411      C411_2016           2015_2016       mk4083     2015-06-12</span></span>
<span><span class="co">#&gt; 4      C411      C411_2016           2015_2016       mk4083     2015-06-12</span></span>
<span><span class="co">#&gt; 5      C411      C411_2016           2015_2016       mk4083     2015-06-12</span></span>
<span><span class="co">#&gt; 6      C411      C411_2016           2015_2016       mk4083     2015-06-12</span></span>
<span><span class="co">#&gt;          end_datetime year_tracked                species</span></span>
<span><span class="co">#&gt; 1 2016-01-05 23:59:59    2015_2016 Black-legged kittiwake</span></span>
<span><span class="co">#&gt; 2 2016-01-05 23:59:59    2015_2016 Black-legged kittiwake</span></span>
<span><span class="co">#&gt; 3 2016-01-05 23:59:59    2015_2016 Black-legged kittiwake</span></span>
<span><span class="co">#&gt; 4 2016-01-05 23:59:59    2015_2016 Black-legged kittiwake</span></span>
<span><span class="co">#&gt; 5 2016-01-05 23:59:59    2015_2016 Black-legged kittiwake</span></span>
<span><span class="co">#&gt; 6 2016-01-05 23:59:59    2015_2016 Black-legged kittiwake</span></span>
<span><span class="co">#&gt;                    date_time  sun_angle eqfilter    lon_raw  lat_raw</span></span>
<span><span class="co">#&gt; 1 2015-06-26 23:52:50.877155 -0.5000000     TRUE   2.513619 55.27382</span></span>
<span><span class="co">#&gt; 2      2015-06-27 11:53:03.5 -0.5022321     TRUE   2.487036 55.31046</span></span>
<span><span class="co">#&gt; 3        2015-06-27 23:08:04 -0.5044643     TRUE  13.759251 60.39885</span></span>
<span><span class="co">#&gt; 4        2015-06-29 11:51:13 -0.5111607     TRUE   3.049667 63.94152</span></span>
<span><span class="co">#&gt; 5   2015-07-02 00:49:34.1875 -0.5133929     TRUE -11.413749 62.65435</span></span>
<span><span class="co">#&gt; 6 2015-07-03 00:53:24.666667 -0.5156250     TRUE -12.326723 63.02963</span></span>
<span><span class="co">#&gt;   lon_smooth1 lat_smooth1        lon      lat                    tFirst</span></span>
<span><span class="co">#&gt; 1    2.513619    55.25641   2.506975 55.26563 2015-06-26 20:31:44.37931</span></span>
<span><span class="co">#&gt; 2    2.500327    55.27485   5.216402 56.58849   2015-06-27 03:13:57.375</span></span>
<span><span class="co">#&gt; 3    8.123143    57.83874   9.619807 59.51800   2015-06-27 20:32:09.625</span></span>
<span><span class="co">#&gt; 4    6.510926    63.12527   6.510926 63.12527       2015-06-29 01:34:41</span></span>
<span><span class="co">#&gt; 5  -11.413749    62.64140 -11.413749 62.64140       2015-07-01 22:40:07</span></span>
<span><span class="co">#&gt; 6  -12.326723    63.01702  -8.043379 63.17219       2015-07-02 22:48:38</span></span>
<span><span class="co">#&gt;                      tSecond type  colony col_lat col_lon sun_angle_start</span></span>
<span><span class="co">#&gt; 1    2015-06-27 03:13:57.375    2 Sklinna  65.202  10.995            -0.5</span></span>
<span><span class="co">#&gt; 2    2015-06-27 20:32:09.625    1 Sklinna  65.202  10.995            -0.5</span></span>
<span><span class="co">#&gt; 3    2015-06-28 01:43:58.375    2 Sklinna  65.202  10.995            -0.5</span></span>
<span><span class="co">#&gt; 4        2015-06-29 22:07:45    1 Sklinna  65.202  10.995            -0.5</span></span>
<span><span class="co">#&gt; 5    2015-07-02 02:59:01.375    2 Sklinna  65.202  10.995            -0.5</span></span>
<span><span class="co">#&gt; 6 2015-07-03 02:58:11.333333    2 Sklinna  65.202  10.995            -0.5</span></span>
<span><span class="co">#&gt;   sun_angle_end light_threshold noon_filter daylength_filter coast_to_land</span></span>
<span><span class="co">#&gt; 1         -1.25              50        TRUE             TRUE           100</span></span>
<span><span class="co">#&gt; 2         -1.25              50        TRUE             TRUE           100</span></span>
<span><span class="co">#&gt; 3         -1.25              50        TRUE             TRUE           100</span></span>
<span><span class="co">#&gt; 4         -1.25              50        TRUE             TRUE           100</span></span>
<span><span class="co">#&gt; 5         -1.25              50        TRUE             TRUE           100</span></span>
<span><span class="co">#&gt; 6         -1.25              50        TRUE             TRUE           100</span></span>
<span><span class="co">#&gt;   coast_to_sea loess_filter_k months_breeding_start months_breeding_end</span></span>
<span><span class="co">#&gt; 1          Inf              6                     4                   8</span></span>
<span><span class="co">#&gt; 2          Inf              6                     4                   8</span></span>
<span><span class="co">#&gt; 3          Inf              6                     4                   8</span></span>
<span><span class="co">#&gt; 4          Inf              6                     4                   8</span></span>
<span><span class="co">#&gt; 5          Inf              6                     4                   8</span></span>
<span><span class="co">#&gt; 6          Inf              6                     4                   8</span></span>
<span><span class="co">#&gt;   boundary.box_xmin boundary.box_xmax boundary.box_ymin boundary.box_ymax</span></span>
<span><span class="co">#&gt; 1               -95               100                30                88</span></span>
<span><span class="co">#&gt; 2               -95               100                30                88</span></span>
<span><span class="co">#&gt; 3               -95               100                30                88</span></span>
<span><span class="co">#&gt; 4               -95               100                30                88</span></span>
<span><span class="co">#&gt; 5               -95               100                30                88</span></span>
<span><span class="co">#&gt; 6               -95               100                30                88</span></span>
<span><span class="co">#&gt;         analyzer date_retrieved logger_producer ring_number country_code</span></span>
<span><span class="co">#&gt; 1 Kate Kittiwake     2017-06-11        Biotrack     6211704          NOS</span></span>
<span><span class="co">#&gt; 2 Kate Kittiwake     2017-06-11        Biotrack     6211704          NOS</span></span>
<span><span class="co">#&gt; 3 Kate Kittiwake     2017-06-11        Biotrack     6211704          NOS</span></span>
<span><span class="co">#&gt; 4 Kate Kittiwake     2017-06-11        Biotrack     6211704          NOS</span></span>
<span><span class="co">#&gt; 5 Kate Kittiwake     2017-06-11        Biotrack     6211704          NOS</span></span>
<span><span class="co">#&gt; 6 Kate Kittiwake     2017-06-11        Biotrack     6211704          NOS</span></span></code></pre></div>
<p>Note our extra metadata appended to the end.</p>
<p>Maps are automatically exported.</p>
<p><img src="example_files/figure-html/plot%20positions-1.png" class="r-plt" width="100%"></p>
<p>It is worth examining the filter plots too.</p>
<p><img src="example_files/figure-html/filterplot_1-1.png" class="r-plt" width="100%" style="display: block; margin: auto;"></p>
<p><img src="example_files/figure-html/filterplot_2-1.png" class="r-plt" width="100%" style="display: block; margin: auto;"></p>
<p><img src="example_files/figure-html/filterplot_3-1.png" class="r-plt" width="100%" style="display: block; margin: auto;"></p>
<p><img src="example_files/figure-html/filterplot_4-1.png" class="r-plt" width="100%" style="display: block; margin: auto;"></p>
<p><img src="example_files/figure-html/filterplot_5-1.png" class="r-plt" width="100%" style="display: block; margin: auto;"></p>
<p><img src="example_files/figure-html/filterplot_6-1.png" class="r-plt" width="100%" style="display: block; margin: auto;"></p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vegard Sandøy Bråthen, Julian Evans.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
